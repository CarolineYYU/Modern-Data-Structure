View(data61.5)
data61.5 <- filter(data61.3, - RESPONDENT  %in% samer && COMPANY_NA %in% "SUBTOTAL")
View(data61.5)
data61.5 <- anti_join(data61.3, same1, by = c("RESPONDEN","COMPANY_NA"))
data61.5 <- anti_join(data61.3, same1, by = c("RESPONDENT","COMPANY_NA"))
View(d1)
data61.4 <- data61.3[,c(1,13:17)]
samer1 <- same1$RESPONDENT
samer1 <- same1$RESPONDENT
data61.5 <- data61.1[-grep("SUBTOTAL", data61.1$COMPANY_NA) && RESPONDENT %in% samer1,]
data61.5 <- data61.1[-grep("SUBTOTAL", data61.1$COMPANY_NA) & RESPONDENT %in% samer1,]
data61.5 <- filter(data61.11, -RESPONDENT %in% samer1)
data61.5 <- filter(data61.11, RESPONDENT %in% samer1)
data61.5 <- filter(data61.11, RESPONDENT %in% samer1)
data61.6 <- anti_join(data61.1, data61.5)
View(d1)
View(data61.4)
dms <- inner_join(diff1, diff2, "RESPONDENT")
dms
View(data61.6)
write.csv(data61.6,file="/Users/carolineyu/Documents/RA-2020 Spring /cleaned data/1995F61_1.csv",quote=F,row.names = F)
dms$RESPONDENT
file.choose()
knitr::opts_chunk$set(echo = TRUE)
da1 <- read.csv("/Users/carolineyu/Documents/RA-2020 Spring /cleaned data/1995F61_1.csv")
da2 <- da1 %>%
group_by(RESPONDENT)
da2 <- da2[grep("Subtotal", data61.1$COMPANY_NA),]
da2 <- da1 %>%
group_by(RESPONDENT)
da2 <- da2[grep("Subtotal", da1$COMPANY_NA),]
da1 <- read.csv("/Users/carolineyu/Documents/RA-2020 Spring /cleaned data/1995F61_1.csv")
da2 <- da1 %>%
group_by(RESPONDENT)
da2 <- da2[grep("Subtotal", da1$COMPANY_NA),]
da1 <- read.csv("/Users/carolineyu/Documents/RA-2020 Spring /cleaned data/1995F61_1.csv")
da2 <- da1 %>%
group_by(RESPONDENT)
da3 <- da2[grep("Subtotal", da1$COMPANY_NA),]
da4 <- da2[grep("Total", da1$COMPANY_NA),]
View(da3)
tomwh <-  summarise(group_by(da2,RESPONDENT), sum(MWH_SOLD))
tomwh <-  summarise(group_by(da3,RESPONDENT), sum(MWH_SOLD))
todecha <- summarise(group_by(da3,RESPONDENT),sum(DEMAND_CHA))
toencha <- summarise(group_by(da3,RESPONDENT), sum(ENERGY_CHA))
toothcha <- summarise(group_by(da3,RESPONDENT), sum(OTHER_CHAR))
tomwh <-  summarise(group_by(da3,RESPONDENT), sum(MWH_SOLD),na.rm=TRUE)
tomwh <-  summarise(group_by(da3,RESPONDENT), sum(MWH_SOLD,na.rm=TRUE))
tomwh <-  summarise(group_by(da3,RESPONDENT), sum(MWH_SOLD, na.rm=TRUE))
tomwh <-  summarise(group_by(da3,RESPONDENT), sum(MWH_SOLD))
da5 <- da3 %>%
group_by(RESPONDENT)%>%
summarise(sum(MWH_SOLD))
da5 <- da3 %>%
group_by(RESPONDENT)%>%
sum(MWH_SOLD)
d5 <- select(c(1,13:17))
d5 <- select(,c(1,13:17))
d5 <- select(c(1,13:17),)
d5 <- select(da3, c(1,13:17))
View(d5)
data61.4 <- data61.3[,c(1,14:18)]
data61.4 <- data61.3[,c(1,13:17)]
View(data61.4)
View(d5)
d5 <- select(da3, c(1,14:18))
tomwh <-  summarise(group_by(da5,RESPONDENT), sum(MWH_SOLD))
tomwh <-  summarise(group_by(d5,RESPONDENT), sum(MWH_SOLD))
d6 <- as.numeric(d5)
tomwh <-  summarise(group_by(d5,RESPONDENT), sum(MWH_SOLD))
da6 <- d5 %>%
group_by(RESPONDENT)%>%
summarise(sum(MWH_SOLD))
is.numeric(d5$MWH_SOLD)
is.factor(d5$MWH_SOLD)
as.numeric(d5$MWH_SOLD)
da6 <- d5 %>%
group_by(RESPONDENT)%>%
summarise(sum(MWH_SOLD))
da6 <- d5 %>%
group_by(RESPONDENT)%>%
summarise(sum(as.numeric(MWH_SOLD)))
View(da6)
da6 <- d5 %>%
group_by(RESPONDENT)%>%
summarise(sum(as.numeric(MWH_SOLD)),sum(as.numeric(DEMAND_CHA)),sum(as.numeric(ENERGY_CHA)),sum(as.numeric(OTHER_CHAR)),sum(as.numeric(TOT_REVENU)))
View(da6)
colnames(da6) <- colnames(d5)
View(da6)
same2 <- inner_join(da6, da4)
samer2 <- same2$RESPONDENT
da7 <- filter(da3, RESPONDENT %in% samer2)
data8 <- anti_join(da2, da7)
write.csv(data61.6,file="/Users/carolineyu/Documents/RA-2020 Spring /cleaned data/1995copyF61_1.csv",quote=F,row.names = F)
write.csv(data8,file="/Users/carolineyu/Documents/RA-2020 Spring /cleaned data/1995copyF61_1.csv",quote=F,row.names = F)
da42 <-select(da4, c(1,14:18))
same2 <- inner_join(da6, da42)
View(da42)
View(da6)
View(d5)
d5 <- select(da3, c(1,14:18))
tomwh <-  summarise(group_by(d5,RESPONDENT), sum(as.numeric(MWH_SOLD)))
todecha <- summarise(group_by(d5,RESPONDENT),as.numeric(DEMAND_CHA)))
tomwh <-  summarise(group_by(d5,RESPONDENT), sum(as.numeric(MWH_SOLD)))
todecha <- summarise(group_by(d5,RESPONDENT),sum(as.numeric(DEMAND_CHA)))
toencha <- summarise(group_by(d5,RESPONDENT), sum(as.numeric(ENERGY_CHA)))
toothcha <- summarise(group_by(d5,RESPONDENT), sum(as.numeric(OTHER_CHAR)))
torev <-  summarise(group_by(d5,RESPONDENT), sum(as.numeric(TOT_REVENU)))
dn1 <- merge(tomwh, todecha)
dn2 <- merge(toencha, toothcha)
dn1 <-  merge(dn1, dn2)
dn1 <- merge(dn1, torev)
View(dn1)
View(todecha)
dn11 <- dn1%>%
arrange(RESPONDENT)
View(dn11)
dn1$RESPONDENT <- as.numeric(dn1$RESPONDENT)
View(dn1)
View(dn1)
View(d5)
str(da1)
tomwh <-  summarise(group_by(d5,as.numeric(RESPONDENT)), sum(as.numeric(MWH_SOLD)))
todecha <- summarise(group_by(d5,as.numeric(RESPONDENT)),sum(as.numeric(DEMAND_CHA)))
toencha <- summarise(group_by(d5,as.numeric(RESPONDENT)), sum(as.numeric(ENERGY_CHA)))
toothcha <- summarise(group_by(d5,as.numeric(RESPONDENT)), sum(as.numeric(OTHER_CHAR)))
torev <-  summarise(group_by(d5,as.numeric(RESPONDENT)), sum(as.numeric(TOT_REVENU)))
dn1 <- merge(tomwh, todecha)
dn2 <- merge(toencha, toothcha)
dn1 <-  merge(dn1, dn2)
dn1 <- merge(dn1, torev)
View(dn1)
View(todecha)
d5 <- select(da3, c(1,14:18))
View(d5)
da6 <- d5 %>%
group_by(as.numeric(RESPONDENT))%>%
summarise(sum(as.numeric(MWH_SOLD)),sum(as.numeric(DEMAND_CHA)),sum(as.numeric(ENERGY_CHA)),sum(as.numeric(OTHER_CHAR)),sum(as.numeric(TOT_REVENU)))
View(da6)
tomwh <-  summarise(group_by(d5,as.numeric(RESPONDENT)), sum(as.numeric(MWH_SOLD)))
todecha <- summarise(group_by(d5,as.numeric(RESPONDENT)),sum(as.numeric(DEMAND_CHA)))
toencha <- summarise(group_by(d5,as.numeric(RESPONDENT)), sum(as.numeric(ENERGY_CHA)))
toothcha <- summarise(group_by(d5,as.numeric(RESPONDENT)), sum(as.numeric(OTHER_CHAR)))
torev <-  summarise(group_by(d5,as.numeric(RESPONDENT)), sum(as.numeric(TOT_REVENU)))
dn1 <- merge(tomwh, todecha)
dn2 <- merge(toencha, toothcha)
dn1 <-  merge(dn1, dn2)
dn1 <- merge(dn1, torev)
View(dn1)
View(d5)
da2 <- da1 %>%
group_by(RESPONDENT)
da3 <- da2[grep("Subtotal", da2$COMPANY_NA),]
da4 <- da2[grep("Total", da2$COMPANY_NA),]
da42 <-select(da4, c(1,14:18))
d5 <- select(da3, c(1,14:18))
View(d5)
tomwh <-  summarise(group_by(d5,as.numeric(RESPONDENT)), sum(as.numeric(MWH_SOLD)))
todecha <- summarise(group_by(d5,as.numeric(RESPONDENT)),sum(as.numeric(DEMAND_CHA)))
toencha <- summarise(group_by(d5,as.numeric(RESPONDENT)), sum(as.numeric(ENERGY_CHA)))
toothcha <- summarise(group_by(d5,as.numeric(RESPONDENT)), sum(as.numeric(OTHER_CHAR)))
torev <-  summarise(group_by(d5,as.numeric(RESPONDENT)), sum(as.numeric(TOT_REVENU)))
dn1 <- merge(tomwh, todecha)
dn2 <- merge(toencha, toothcha)
dn1 <-  merge(dn1, dn2)
dn1 <- merge(dn1, torev)
View(dn1)
da3 <- data61.1[grep("Subtotal", data61.1$COMPANY_NA),]
da4 <- data61.1[grep("Total", data61.1$COMPANY_NA),]
View(da3)
totalmwh2 <-  summarise(group_by(da3,RESPONDENT), sum(MWH_SOLD))
totaldecha2 <- summarise(group_by(da3,RESPONDENT),sum(DEMAND_CHA))
totalencha2 <- summarise(group_by(da3,RESPONDENT), sum(ENERGY_CHA))
totalothcha2 <- summarise(group_by(da3,RESPONDENT), sum(OTHER_CHAR))
totalrev2 <-  summarise(group_by(da3,RESPONDENT), sum(TOT_REVENU))
dn1 <- merge(totalmwh2, totaldecha2)
dn2 <- merge(totalencha2, totalothcha2)
dn1 <-  merge(dn1, dn2)
dn1 <- merge(dn1, totalrev2)
da5 <- da4[,c(1,13:17)]
View(da5)
da6 <- rbind(d5,data61.4)
da6 <- rbind(da5,data61.4)
View(da6)
dn3 <- rbind(d1, dn1)
colnames(dn1) <- colnames(da6)
dn3 <- rbind(d1, dn1)
same1 <- inner_join(da6, dn3)
samer1 <- same1$RESPONDENT
diff1 <- anti_join(da6, dn3)
diff2 <- anti_join(dn3, da6)
same1 <- inner_join(da6, dn3)
samer1 <- same1$RESPONDENT
data61.12 <- rbind(data61.11,da3)
data61.5 <- filter(data61.12, RESPONDENT %in% samer1)
data61.6 <- anti_join(data61.1, data61.5)
dms <- inner_join(diff1, diff2, "RESPONDENT")
dms
dms$RESPONDENT
write.csv(data61.6,file="/Users/carolineyu/Documents/RA-2020 Spring /cleaned data/1995F61_1c.csv",quote=F,row.names = F)
View(diff1)
View(dn3)
View(d5)
View(da5)
View(da4)
da41 <- da4[grep("SubTotal", data61.1$COMPANY_NA),]
da42 <- anti_join(da4, da41)
View(da42)
View(da41)
da41 <- da4[grep("SubTotal", da4$COMPANY_NA),]
da42 <- anti_join(da4, da41)
View(da42)
data61.12 <- rbind(data61.11,da3,da41)
data61.12 <- rbind(data61.11,da3)
data61.12 <- rbind(data61.11,da3,da41)
totalmwh <-  summarise(group_by(data61.12,RESPONDENT), sum(MWH_SOLD))
totaldecha <- summarise(group_by(data61.12,RESPONDENT),sum(DEMAND_CHA))
totalencha <- summarise(group_by(data61.12,RESPONDENT), sum(ENERGY_CHA))
totalothcha <- summarise(group_by(data61.12,RESPONDENT), sum(OTHER_CHAR))
totalrev <-  summarise(group_by(data61.12,RESPONDENT), sum(TOT_REVENU))
d1 <- merge(totalmwh, totaldecha)
d2 <- merge(totalencha, totalothcha)
d1 <-  merge(d1, d2)
d1 <- merge(d1, totalrev)
datatotal <- rbind(data61.3,da42)
View(datatotal)
data61.4 <- datatotal[,c(1,13:17)]
colnames(d1) <- colnames(data61.4)
diff1 <- anti_join(da6, dn3)
same1 <- inner_join(d1, data61.4)
samer1 <- same1$RESPONDENT
samer1 <- same1$RESPONDENT
data61.5 <- filter(data61.12, RESPONDENT %in% samer1)
data61.6 <- anti_join(data61.1, data61.5)
write.csv(data61.6,file="/Users/carolineyu/Documents/RA-2020 Spring /cleaned data/1995F61_1c.csv",quote=F,row.names = F)
dms <- inner_join(diff1, diff2, "RESPONDENT")
dms
diff2 <- anti_join(d1, data61.4)
diff1 <- anti_join(data61.4, d1)
dms <- inner_join(diff1, diff2, "RESPONDENT")
dms
dms$RESPONDENT
fun1 <- function(x){
max = max(x, na.rm = TRUE),
fun1 <- function(x){
max = max(x, na.rm = TRUE)
min = min(x, na.rm = TRUE)
med = median(x, na.rm = TRUE)
}
a <- c(1,2,3,4,5)
fun1(a)
a <- c(1,2,3,4,5)
b <- fun1(a)
fun1 <- function(x){
max = max(x, na.rm = TRUE)
min = min(x, na.rm = TRUE)
med = median(x, na.rm = TRUE)
}
a <- c(1,2,3,4,5)
b <- fun1(a)
b
fun1 <- function(x){
max = max(x, na.rm = TRUE)
min = min(x, na.rm = TRUE)
med = median(x, na.rm = TRUE)
return(max,min,med)
}
a <- c(1,2,3,4,5)
b <- fun1(a)
fun1 <- function(x){
max = max(x, na.rm = TRUE)
min = min(x, na.rm = TRUE)
med = median(x, na.rm = TRUE)
ret <- c(max, med,min)
}
a <- c(1,2,3,4,5)
b <- fun1(a)
b
flights
data(flights)
library(nycflights13)
flights
fun1(flights$month)
b <- fun1(flights$month)
b
fun2 <- function(x, y){
mutate(y, case_when(
x >= 500 && x < 1159 ~ "Morning"
x >= 1200 && x < 1659 ~ "Afternoon"
fun2 <- function(x, y){
mutate(y, case_when(
x >= 500 && x < 1159 ~ "Morning",
x >= 1200 && x < 1659 ~ "Afternoon",
x >= 1700 && x < 2059 ~ "Evening",
x >= 2100 | x < 459 ~ "Night"
))
}
print(fun2(flights$dep_time))
fun2(flights$dep_time)
fun2 <- function(x, y = 0){
mutate(y, case_when(
x >= 500 && x < 1159 ~ "Morning",
x >= 1200 && x < 1659 ~ "Afternoon",
x >= 1700 && x < 2059 ~ "Evening",
x >= 2100 | x < 459 ~ "Night"
))
}
fun2(flights$dep_time)
x <- 1:50
case_when(
x %% 35 == 0 ~ "fizz buzz",
x %% 5 == 0 ~ "fizz",
x %% 7 == 0 ~ "buzz",
TRUE ~ as.character(x)
)
x <- flights$dep_time
case_when(
x >= 500 && x < 1159 ~ "Morning",
x >= 1200 && x < 1659 ~ "Afternoon",
x >= 1700 && x < 2059 ~ "Evening",
x >= 2100 | x < 459 ~ "Night"
)
fun2 <- function(x, y = 0){
mutate(y, case_when(
x >= 500 && x < 1159 ~ "Morning",
x >= 1200 && x < 1659 ~ "Afternoon",
x >= 1700 && x < 2059 ~ "Evening",
x >= 2100 | x < 459 ~ "Night"
))
return(y)
}
fun2(flights$dep_time)
fun2 <- function(x, y = 0){
mutate(y = case_when(
x >= 500 && x < 1159 ~ "Morning",
x >= 1200 && x < 1659 ~ "Afternoon",
x >= 1700 && x < 2059 ~ "Evening",
x >= 2100 | x < 459 ~ "Night"
))
return(y)
}
fun2(flights$dep_time)
fun2(flights$dep_time, category)
fun2 <- function(x){
mutate(y = case_when(
x >= 500 && x < 1159 ~ "Morning",
x >= 1200 && x < 1659 ~ "Afternoon",
x >= 1700 && x < 2059 ~ "Evening",
x >= 2100 | x < 459 ~ "Night"
))
return(y)
}
fun2(flights$dep_time, category)
fun2(flights$dep_time)
fun2 <- function(x, y){
mutate(y = case_when(
x >= 500 && x < 1159 ~ "Morning",
x >= 1200 && x < 1659 ~ "Afternoon",
x >= 1700 && x < 2059 ~ "Evening",
x >= 2100 | x < 459 ~ "Night"
))
return(y)
}
fun2(flights$dep_time, Cate)
?hist
fun2(flights$dep_time, Cate)
fun2 <- function(x, y){
mutate(x , y = case_when(
x >= 500 && x < 1159 ~ "Morning",
x >= 1200 && x < 1659 ~ "Afternoon",
x >= 1700 && x < 2059 ~ "Evening",
x >= 2100 | x < 459 ~ "Night"
))
return(y)
}
fun2(flights$dep_time, Cate)
fun2 <- function(x, y){
mutate(flights , y = case_when(
x >= 500 && x < 1159 ~ "Morning",
x >= 1200 && x < 1659 ~ "Afternoon",
x >= 1700 && x < 2059 ~ "Evening",
x >= 2100 | x < 459 ~ "Night"
))
return(y)
}
fun2(flights$dep_time, Cate)
fun2(flights$dep_time, y)
fun2 <- function(x, y = NULL){
mutate(flights , y = case_when(
x >= 500 && x < 1159 ~ "Morning",
x >= 1200 && x < 1659 ~ "Afternoon",
x >= 1700 && x < 2059 ~ "Evening",
x >= 2100 | x < 459 ~ "Night"
))
return(y)
}
fun2(flights$dep_time, y)
?mutate()
fun2 <- function(x, y ){
mutate(x, y = case_when(
x >= 500 && x < 1159 ~ "Morning",
x >= 1200 && x < 1659 ~ "Afternoon",
x >= 1700 && x < 2059 ~ "Evening",
x >= 2100 | x < 459 ~ "Night"
))
return(y)
}
fun2 <- function(x, y ){
mutate(x, cat = case_when(
y >= 500 && y < 1159 ~ "Morning",
y >= 1200 && y < 1659 ~ "Afternoon",
y >= 1700 && y < 2059 ~ "Evening",
y >= 2100 | y < 459 ~ "Night"
))
}
fun2(flights, dep_time )
dep_time
fun2 <- function(x, y){
mutate(x, cat = case_when(
x$y >= 500 && x$y < 1159 ~ "Morning",
x$y >= 1200 && x$y < 1659 ~ "Afternoon",
x$y >= 1700 && x$y < 2059 ~ "Evening",
x$y >= 2100 | x$y < 459 ~ "Night"
))
}
fun2(flights, dep_time)
fun2 <- function(x, y){
mutate(x, case_when(
x$y >= 500 && x$y < 1159 ~ "Morning",
x$y >= 1200 && x$y < 1659 ~ "Afternoon",
x$y >= 1700 && x$y < 2059 ~ "Evening",
x$y >= 2100 | x$y < 459 ~ "Night"
))
}
fun2(flights, dep_time)
fun2 <- function(x, y){
mutate(x, case_when(
y >= 500 && y < 1159 ~ "Morning",
y >= 1200 && y < 1659 ~ "Afternoon",
y >= 1700 && y < 2059 ~ "Evening",
y >= 2100 | y < 459 ~ "Night"
))
}
fun2(flights, dep_time)
View(fun2)
num <- flights
for (i in flights){
if( is.numeric(i) == FALSE){
next
} else if{
num <- flights
for (i in flights){
if( is.numeric(i) == FALSE)
next
} else if{
num <- flights
for (i in flights){
if( is.numeric(i) == FALSE){
next
} else{
med = median(med)
}
}
fun2 <- function(data, colname){
mutate(data,category =  case_when(
data[[colname]] >= 500 && data[[colname]] < 1159 ~ "Morning",
data[[colname]] >= 1200 && data[[colname]] < 1659 ~ "Afternoon",
data[[colname]] >= 1700 && data[[colname]] < 2059 ~ "Evening",
data[[colname]] >= 2100 | data[[colname]] < 459 ~ "Night"
))
}
fun2 <- function(data, colname){
mutate(data,category =  case_when(
data[[colname]] >= 500 && data[[colname]] < 1159 ~ "Morning",
data[[colname]] >= 1200 && data[[colname]] < 1659 ~ "Afternoon",
data[[colname]] >= 1700 && data[[colname]] < 2059 ~ "Evening",
data[[colname]] >= 2100 | data[[colname]] < 459 ~ "Night"
))
}
fun2(flights, "dep_time")
category <- function(data, colname){
mutate(data,category =  case_when(
data[[colname]] >= 500 && data[[colname]] < 1159 ~ "Morning",
data[[colname]] >= 1200 && data[[colname]] < 1659 ~ "Afternoon",
data[[colname]] >= 1700 && data[[colname]] < 2059 ~ "Evening",
data[[colname]] >= 2100 | data[[colname]] < 459 ~ "Night"
))
}
category(flights, "dep_time")
b <- category(flights, "dep_time")
b %>%
select(dep_time, category) %>%
head(10)
str(flights)
num <- select(flights, -carrier, -tailnum, -origin, -dest)
cmedian <- function(df){
output <- vector("double",ncol(df))
for(i in seq_along(df)){
output[[i]] <- median(df[[i]])
}
output
}
cmedian(num)
num <- select(flights, -carrier, -tailnum, -origin, -dest)
cmedian <- function(df){
output <- vector("double",ncol(df))
for(i in seq_along(df)){
output[[i]] <- median(df[[i]], na.rm = TRUE)
}
output
}
cmedian(num)
